(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{410:function(e,t,r){var map={"./af":279,"./af.js":279,"./ar":280,"./ar-dz":281,"./ar-dz.js":281,"./ar-kw":282,"./ar-kw.js":282,"./ar-ly":283,"./ar-ly.js":283,"./ar-ma":284,"./ar-ma.js":284,"./ar-sa":285,"./ar-sa.js":285,"./ar-tn":286,"./ar-tn.js":286,"./ar.js":280,"./az":287,"./az.js":287,"./be":288,"./be.js":288,"./bg":289,"./bg.js":289,"./bm":290,"./bm.js":290,"./bn":291,"./bn.js":291,"./bo":292,"./bo.js":292,"./br":293,"./br.js":293,"./bs":294,"./bs.js":294,"./ca":295,"./ca.js":295,"./cs":296,"./cs.js":296,"./cv":297,"./cv.js":297,"./cy":298,"./cy.js":298,"./da":299,"./da.js":299,"./de":300,"./de-at":301,"./de-at.js":301,"./de-ch":302,"./de-ch.js":302,"./de.js":300,"./dv":303,"./dv.js":303,"./el":304,"./el.js":304,"./en-SG":305,"./en-SG.js":305,"./en-au":306,"./en-au.js":306,"./en-ca":307,"./en-ca.js":307,"./en-gb":308,"./en-gb.js":308,"./en-ie":309,"./en-ie.js":309,"./en-il":310,"./en-il.js":310,"./en-nz":311,"./en-nz.js":311,"./eo":312,"./eo.js":312,"./es":313,"./es-do":314,"./es-do.js":314,"./es-us":315,"./es-us.js":315,"./es.js":313,"./et":316,"./et.js":316,"./eu":317,"./eu.js":317,"./fa":318,"./fa.js":318,"./fi":319,"./fi.js":319,"./fo":320,"./fo.js":320,"./fr":321,"./fr-ca":322,"./fr-ca.js":322,"./fr-ch":323,"./fr-ch.js":323,"./fr.js":321,"./fy":324,"./fy.js":324,"./ga":325,"./ga.js":325,"./gd":326,"./gd.js":326,"./gl":327,"./gl.js":327,"./gom-latn":328,"./gom-latn.js":328,"./gu":329,"./gu.js":329,"./he":330,"./he.js":330,"./hi":331,"./hi.js":331,"./hr":332,"./hr.js":332,"./hu":333,"./hu.js":333,"./hy-am":334,"./hy-am.js":334,"./id":335,"./id.js":335,"./is":336,"./is.js":336,"./it":337,"./it-ch":338,"./it-ch.js":338,"./it.js":337,"./ja":339,"./ja.js":339,"./jv":340,"./jv.js":340,"./ka":341,"./ka.js":341,"./kk":342,"./kk.js":342,"./km":343,"./km.js":343,"./kn":344,"./kn.js":344,"./ko":345,"./ko.js":345,"./ku":346,"./ku.js":346,"./ky":347,"./ky.js":347,"./lb":348,"./lb.js":348,"./lo":349,"./lo.js":349,"./lt":350,"./lt.js":350,"./lv":351,"./lv.js":351,"./me":352,"./me.js":352,"./mi":353,"./mi.js":353,"./mk":354,"./mk.js":354,"./ml":355,"./ml.js":355,"./mn":356,"./mn.js":356,"./mr":357,"./mr.js":357,"./ms":358,"./ms-my":359,"./ms-my.js":359,"./ms.js":358,"./mt":360,"./mt.js":360,"./my":361,"./my.js":361,"./nb":362,"./nb.js":362,"./ne":363,"./ne.js":363,"./nl":364,"./nl-be":365,"./nl-be.js":365,"./nl.js":364,"./nn":366,"./nn.js":366,"./pa-in":367,"./pa-in.js":367,"./pl":368,"./pl.js":368,"./pt":369,"./pt-br":370,"./pt-br.js":370,"./pt.js":369,"./ro":371,"./ro.js":371,"./ru":372,"./ru.js":372,"./sd":373,"./sd.js":373,"./se":374,"./se.js":374,"./si":375,"./si.js":375,"./sk":376,"./sk.js":376,"./sl":377,"./sl.js":377,"./sq":378,"./sq.js":378,"./sr":379,"./sr-cyrl":380,"./sr-cyrl.js":380,"./sr.js":379,"./ss":381,"./ss.js":381,"./sv":382,"./sv.js":382,"./sw":383,"./sw.js":383,"./ta":384,"./ta.js":384,"./te":385,"./te.js":385,"./tet":386,"./tet.js":386,"./tg":387,"./tg.js":387,"./th":388,"./th.js":388,"./tl-ph":389,"./tl-ph.js":389,"./tlh":390,"./tlh.js":390,"./tr":391,"./tr.js":391,"./tzl":392,"./tzl.js":392,"./tzm":393,"./tzm-latn":394,"./tzm-latn.js":394,"./tzm.js":393,"./ug-cn":395,"./ug-cn.js":395,"./uk":396,"./uk.js":396,"./ur":397,"./ur.js":397,"./uz":398,"./uz-latn":399,"./uz-latn.js":399,"./uz.js":398,"./vi":400,"./vi.js":400,"./x-pseudo":401,"./x-pseudo.js":401,"./yo":402,"./yo.js":402,"./zh-cn":403,"./zh-cn.js":403,"./zh-hk":404,"./zh-hk.js":404,"./zh-tw":405,"./zh-tw.js":405};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}n.keys=function(){return Object.keys(map)},n.resolve=o,e.exports=n,n.id=410},533:function(e,t,r){"use strict";r.r(t);r(406),r(33);var n,o,l,c,d,f=r(6),h=r(278),m=r.n(h),j=r(434),_=r.n(j),v={name:"OfferPage",data:function(){return{student_name:"",student_id:"",objId:"",enrolled:[],OfferOpt:[],isPaginated:!0,isPaginationSimple:!1,paginationPosition:"bottom",defaultSortDirection:"desc",sortIcon:"arrow-up",sortIconSize:"is-small",currentPage:1,perPage:10,defaultOpenedDetails:[],tmpRow:{},co_course_id:"",co_year:(new Date).getFullYear(),co_date:new Date,createBlock_isopen:!1}},filters:{timeFormat:function(i){return m()(i,"YYYY-MM-DDTHH:mm:ssZ").format("YYYY-MM-DD HH:mm:ss")}},computed:{createOptCourse:function(){return this.OfferOpt?this.OfferOpt.reduce(function(i,e){return 0!==i.length&&i[i.length-1].course_id===e.course_id||i.push(e),i},[]):[]},createOptYear:function(){var e=this;return this.OfferOpt?this.OfferOpt.filter(function(t){return t.course_id==e.co_course_id}):[]},editOptYear:function(){var e=this;return this.OfferOpt?this.OfferOpt.filter(function(t){return t.course_id==e.tmpRow.course_id}):[]}},methods:{fetchStudent:(d=Object(f.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$get("/api/v1/g/student/"+this.$route.params.id);case 3:t=e.sent,this.student_name=t.data.student_name,this.student_id=t.data.student_id,this.objId=t.data._id,this.enrolled=t.data.enrolled,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),this.$buefy.toast.open({message:"The Requested Student is not exist",type:"is-warning",position:"is-bottom"}),this.$router.push({path:"/student/"+this.$route.params.id});case 14:case"end":return e.stop()}},e,this,[[0,10]])})),function(){return d.apply(this,arguments)}),fetchOffer:(c=Object(f.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$get('/api/v1/l/course/_/offer?available_places={"gt":0}');case 3:t=e.sent,this.OfferOpt=t.data,console.log(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$buefy.toast.open({message:"The Offer List fetching error",type:"is-warning",position:"is-bottom"});case 11:case"end":return e.stop()}},e,this,[[0,8]])})),function(){return c.apply(this,arguments)}),toggle:function(e){this.createBlock_isopen=!1,this.tmpRow=_()(e),this.tmpRow.enroll_date=m()(this.tmpRow.enroll_date).toDate(),this.defaultOpenedDetails.pop(),this.$refs.table.toggleDetails(e)},saveEnroll:(l=Object(f.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.tmpRow),e.prev=1,e.next=4,this.$axios.$post("/api/v1/u/student/"+this.objId+"/enrolled/"+this.tmpRow._id,{year:Number(this.tmpRow.year),enroll_date:String(m()(this.tmpRow.enroll_date).format("YYYY-MM-DDTHH:mm:ssZ")),course_id:String(this.tmpRow.course_id)});case 4:t=e.sent,console.log(t),this.$buefy.toast.open({duration:5e3,message:"Save Success !",position:"is-bottom",type:"is-success"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.$buefy.toast.open({duration:5e3,message:"Save Fail !",position:"is-bottom",type:"is-danger"});case 12:return e.prev=12,this.fetchStudent(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])})),function(){return l.apply(this,arguments)}),warn:function(e){var t=this;console.log(e),this.$buefy.dialog.confirm({title:"Deleting Offer",message:"Are you sure you want to <b>delete</b> this Enroll Record? This action cannot be undone.",confirmText:"Delete Enroll Record",type:"is-danger",hasIcon:!0,onConfirm:function(){return t.deleteEnroll(e)}})},deleteEnroll:(o=Object(f.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$post("/api/v1/d/student/"+this.objId+"/enrolled/"+t._id,{_id:String(t._id)});case 3:e.sent,this.$buefy.toast.open({duration:5e3,message:"deleted !",position:"is-bottom",type:"is-success"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),this.$buefy.toast.open({duration:5e3,message:"Something's not good",position:"is-bottom",type:"is-danger"});case 11:return e.prev=11,this.fetchStudent(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,7,11,14]])})),function(e){return o.apply(this,arguments)}),createReady:function(){this.offers&&this.offer.sort(function(a,b){return b.year-a.year});this.defaultOpenedDetails.pop()},createEnroll:(n=Object(f.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={year:Number(this.co_year),course_id:String(this.co_course_id),enroll_date:String(m()(this.co_date).format("YYYY-MM-DDTHH:mm:ssZ"))},console.log(t),e.prev=2,e.next=5,this.$axios.$post("/api/v1/c/student/"+this.objId+"/enrolled",t);case 5:e.sent,this.$buefy.toast.open({message:"Offer Create Success",type:"is-success",position:"is-bottom"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.warn(e.t0),this.$buefy.toast.open({message:"Offer Create Fail",type:"is-danger",position:"is-bottom"});case 13:return e.prev=13,this.fetchStudent(),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[2,9,13,16]])})),function(){return n.apply(this,arguments)}),cancelCreate:function(){this.createBlock_isopen=!1}},beforeMount:function(){this.fetchStudent(),this.fetchOffer()}},y=r(15),component=Object(y.a)(v,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("section",{staticClass:"hero is-info"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container has-text-left"},[r("p",{staticClass:"title"},[e._v(e._s(e.student_name))]),r("p",{staticClass:"subtitle"},[e._v(e._s(e.student_id))])])]),r("div",{staticClass:"hero-foot"},[r("nav",{staticClass:"tabs is-boxed is-fullwidth"},[r("div",{staticClass:"container"},[r("ul",[r("li",[r("nuxt-link",{attrs:{to:"/student/"+this.objId}},[e._v(" Overview")])],1),r("li",{staticClass:"is-active"},[r("nuxt-link",{attrs:{to:"/student/"+this.objId+"/enrolled"}},[e._v("Enrolled Course List")])],1)])])])])]),r("section",{staticClass:"section"},[r("h2",{staticClass:"title"},[e._v(" Enrolled Course")]),r("div",{staticClass:"container"},[r("div",{staticClass:"columns is-multiline"},[r("div",{staticClass:"column"},[r("b-collapse",{attrs:{open:e.createBlock_isopen,"aria-id":"createEnroll"},on:{"update:open":function(t){e.createBlock_isopen=t}}},[r("b-button",{staticClass:"is-primary",attrs:{slot:"trigger","aria-controls":"createEnroll"},on:{click:function(t){return e.createReady()}},slot:"trigger"},[e._v("Enroll New Course")]),r("section",{staticClass:"section"},[r("b-field",{attrs:{grouped:"","group-multiline":""}},[r("b-field",{attrs:{label:"Course",horizontal:""}},[r("b-select",{attrs:{placeholder:"Select a Course",width:"160"},model:{value:e.co_course_id,callback:function(t){e.co_course_id=t},expression:"co_course_id"}},e._l(e.createOptCourse,function(option){return r("option",{key:option._id,domProps:{value:option.course_id}},[e._v(e._s(option.course_id)+" | "+e._s(option.title))])}),0)],1),r("b-field",{attrs:{label:"Offer",horizontal:""}},[r("b-select",{attrs:{placeholder:"Offer Year"},model:{value:e.co_year,callback:function(t){e.co_year=t},expression:"co_year"}},e._l(e.createOptYear,function(option){return r("option",{key:option.offers._id,domProps:{value:option.offers.year}},[e._v(e._s(option.offers.year)+" ")])}),0)],1),r("b-field",{attrs:{label:"Enroll Date",horizontal:""}},[r("b-datepicker",{model:{value:e.co_date,callback:function(t){e.co_date=t},expression:"co_date"}})],1),r("b-field",[r("b-button",{staticClass:"is-primary",on:{click:function(t){return e.createEnroll()}}},[e._v("Create")])],1),r("b-field",[r("b-button",{on:{click:function(t){return e.cancelCreate()}}},[e._v("Cancel")])],1)],1)],1)],1)],1)]),r("div",{staticClass:"content"},[r("b-table",{ref:"table",attrs:{grouped:"","group-multiline":"",data:e.enrolled,"opened-detailed":e.defaultOpenedDetails,detailed:"","detail-key":"_id","show-detail-icon":!1,loading:!1,paginated:e.isPaginated,"per-page":e.perPage,"current-page":e.currentPage,"pagination-simple":e.isPaginationSimple,"pagination-position":e.paginationPosition,"default-sort-direction":e.defaultSortDirection,"sort-icon":e.sortIcon,"sort-icon-size":e.sortIconSize,"default-sort":"year","aria-next-label":"Next page","aria-previous-label":"Previous page","aria-page-label":"Page","aria-current-label":"Current page"},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-table-column",{attrs:{field:"id",label:"ID",width:"40",visible:!1}},[e._v(e._s(t.row._id))]),r("b-table-column",{attrs:{field:"course",label:"Course",width:"160",sortable:""}},[e._v(e._s(t.row.course_id))]),r("b-table-column",{attrs:{field:"year",label:"Year",width:"100",sortable:""}},[e._v(e._s(t.row.year))]),r("b-table-column",{attrs:{field:"enroll_date",label:"Enroll Date",width:"160",sortable:""}},[e._v(e._s(e._f("timeFormat")(t.row.enroll_date)))]),r("b-table-column",{attrs:{field:"created_at",label:"Created at",width:"160",sortable:""}},[e._v(e._s(e._f("timeFormat")(t.row.created_at)))]),r("b-table-column",{attrs:{field:"updated_at",label:"Last Updated at",width:"160",sortable:""}},[e._v(e._s(e._f("timeFormat")(t.row.updated_at)))]),r("b-table-column",{attrs:{field:"edit",label:"Edit",width:"70"}},[r("b-button",{on:{click:function(r){return e.toggle(t.row)}}},[e._v("Edit")])],1),r("b-table-column",{attrs:{field:"delete",label:"Delete",width:"70"}},[r("b-button",{staticClass:"is-danger",on:{click:function(r){return e.warn(t.row)}}},[e._v("Delete")])],1)]}},{key:"detail",fn:function(t){return[r("section",[r("b-field",{attrs:{grouped:"","group-multiline":""}},[r("b-field",{attrs:{label:"Course",horizontal:""}},[r("b-select",{attrs:{placeholder:"Select a Course",width:"160"},model:{value:e.tmpRow.course_id,callback:function(t){e.$set(e.tmpRow,"course_id",t)},expression:"tmpRow.course_id"}},e._l(e.createOptCourse,function(option){return r("option",{key:option._id,domProps:{value:option.course_id}},[e._v(e._s(option.course_id)+" | "+e._s(option.title))])}),0)],1),r("b-field",{attrs:{label:"Offer",horizontal:""}},[r("b-select",{attrs:{placeholder:"Offer Year"},model:{value:e.tmpRow.year,callback:function(t){e.$set(e.tmpRow,"year",t)},expression:"tmpRow.year"}},e._l(e.editOptYear,function(option){return r("option",{key:option.offers._id,domProps:{value:option.offers.year}},[e._v(e._s(option.offers.year)+" ")])}),0)],1),r("b-field",{attrs:{label:"Enroll Date",horizontal:""}},[r("b-datepicker",{model:{value:e.tmpRow.enroll_date,callback:function(t){e.$set(e.tmpRow,"enroll_date",t)},expression:"tmpRow.enroll_date"}})],1),r("b-field",[r("b-button",{staticClass:"is-primary",on:{click:function(t){return e.saveEnroll()}}},[e._v("Save")])],1),r("b-field",[r("b-button",{on:{click:function(r){return e.closeCancel(t.row)}}},[e._v("Cancel")])],1)],1)],1)]}}])})],1)])])])},[],!1,null,null,null);t.default=component.exports}}]);